library(tidyverse)
rm(list=ls())
fst <- read.table("./ilamina.fst", header=T)


#Some loci are fixed and have NA as Fst values. 
fixed <- fst[is.na(fst$FST),]
write.table(fixed, "./iliamna.fixed.txt", quote=F, row.names = F)

nofixed <- fst %>% 
  na.omit()
write.table(nofixed, "./iliamna.noNa.fst", quote=F, row.names = F)

#HMM input format: a file with FST values with a header 'x' by chromosome. 
chr <- unique(nofixed$CHR)
chr

for (i in chr){
  input <- nofixed %>% 
    filter(CHR==i) %>% 
    select(FST)
  colnames(input)='x'
  write.table(input, paste0("./HMM_iliamna/",i,"_fst_iliamna.txt"), quote=F, row.names=F)
  
}

summary(input)
